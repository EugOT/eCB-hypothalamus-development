<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Evgenii O. Tretiakov">
<meta name="dcterms.date" content="2024-11-19">

<title>eCB expression analysis of Hypothalamus development with focus on PVN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="02-endo-cb_files/libs/clipboard/clipboard.min.js"></script>
<script src="02-endo-cb_files/libs/quarto-html/quarto.js"></script>
<script src="02-endo-cb_files/libs/quarto-html/popper.min.js"></script>
<script src="02-endo-cb_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02-endo-cb_files/libs/quarto-html/anchor.min.js"></script>
<link href="02-endo-cb_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02-endo-cb_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02-endo-cb_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02-endo-cb_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02-endo-cb_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="02-endo-cb_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="02-endo-cb_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#setup-parameters" id="toc-setup-parameters" class="nav-link active" data-scroll-target="#setup-parameters">Setup parameters</a>
  <ul class="collapse">
  <li><a href="#set-paths" id="toc-set-paths" class="nav-link" data-scroll-target="#set-paths">Set paths</a></li>
  <li><a href="#load-helper-functions-and-gene-sets" id="toc-load-helper-functions-and-gene-sets" class="nav-link" data-scroll-target="#load-helper-functions-and-gene-sets">Load helper functions and gene-sets</a></li>
  <li><a href="#set-fixed-variables" id="toc-set-fixed-variables" class="nav-link" data-scroll-target="#set-fixed-variables">Set fixed variables</a></li>
  </ul></li>
  <li><a href="#load-kim-dw-et-al-2020" id="toc-load-kim-dw-et-al-2020" class="nav-link" data-scroll-target="#load-kim-dw-et-al-2020">Load Kim DW et al 2020</a>
  <ul class="collapse">
  <li><a href="#convert-adata-object-to-r-anndatar6-object." id="toc-convert-adata-object-to-r-anndatar6-object." class="nav-link" data-scroll-target="#convert-adata-object-to-r-anndatar6-object.">Convert adata object to R AnnDataR6 object.</a></li>
  </ul></li>
  <li><a href="#load-romanov-et-al-2020" id="toc-load-romanov-et-al-2020" class="nav-link" data-scroll-target="#load-romanov-et-al-2020">Load Romanov et al 2020</a></li>
  <li><a href="#prepare-query-mapping-between-datasets" id="toc-prepare-query-mapping-between-datasets" class="nav-link" data-scroll-target="#prepare-query-mapping-between-datasets">Prepare query mapping between datasets</a></li>
  <li><a href="#intersection-sets-analysis" id="toc-intersection-sets-analysis" class="nav-link" data-scroll-target="#intersection-sets-analysis">Intersection sets analysis</a>
  <ul class="collapse">
  <li><a href="#pvn-neurons-from-kim-et-al.-2020-nature-communications" id="toc-pvn-neurons-from-kim-et-al.-2020-nature-communications" class="nav-link" data-scroll-target="#pvn-neurons-from-kim-et-al.-2020-nature-communications">PVN Neurons from Kim et al.&nbsp;2020, Nature Communications</a></li>
  <li><a href="#pvn-neurons-from-romanov-et-al.-2020-nature" id="toc-pvn-neurons-from-romanov-et-al.-2020-nature" class="nav-link" data-scroll-target="#pvn-neurons-from-romanov-et-al.-2020-nature">PVN Neurons from Romanov et al.&nbsp;2020, Nature</a></li>
  <li><a href="#pvn-neurons-from-both-datasets-joined" id="toc-pvn-neurons-from-both-datasets-joined" class="nav-link" data-scroll-target="#pvn-neurons-from-both-datasets-joined">PVN Neurons from both datasets joined</a></li>
  <li><a href="#contingency-tables" id="toc-contingency-tables" class="nav-link" data-scroll-target="#contingency-tables">Contingency tables</a></li>
  </ul></li>
  <li><a href="#integration-of-pvn-neurons-from-both-datasets" id="toc-integration-of-pvn-neurons-from-both-datasets" class="nav-link" data-scroll-target="#integration-of-pvn-neurons-from-both-datasets">Integration of PVN neurons from both datasets</a></li>
  <li><a href="#dotplots" id="toc-dotplots" class="nav-link" data-scroll-target="#dotplots">Dotplots</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="02-endo-cb.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">eCB expression analysis of Hypothalamus development with focus on PVN</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Evgenii O. Tretiakov </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="setup-parameters" class="level2">
<h2 class="anchored" data-anchor-id="setup-parameters">Setup parameters</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load tidyverse infrastructure packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(future)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(magrittr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(stringr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(skimr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(viridis)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages for scRNA-seq analysis and visualisation</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(UpSetR)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(cowplot)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(patchwork)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggstatsplot)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(anndata)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(sceasy)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(Seurat)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(SeuratDisk)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(SeuratWrappers)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(scCustomize)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"scanpy"</span>, <span class="at">convert =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="set-paths" class="level3">
<h3 class="anchored" data-anchor-id="set-paths">Set paths</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>src_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"code"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"data"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"output"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plots_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(output_dir, <span class="st">"figures/"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tables_dir <span class="ot">&lt;-</span> <span class="fu">here</span>(output_dir, <span class="st">"tables/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load-helper-functions-and-gene-sets" class="level3">
<h3 class="anchored" data-anchor-id="load-helper-functions-and-gene-sets">Load helper functions and gene-sets</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(src_dir, <span class="st">"genes.R"</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(src_dir, <span class="st">"functions.R"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="set-fixed-variables" class="level3">
<h3 class="anchored" data-anchor-id="set-fixed-variables">Set fixed variables</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>reseed <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="at">seed =</span> reseed)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for parallel execution</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(<span class="st">"multisession"</span>, <span class="at">workers =</span> n_cores)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">future.globals.maxSize =</span> <span class="dv">100000</span> <span class="sc">*</span> <span class="dv">1024</span><span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">future.rng.onMisuse =</span> <span class="st">"ignore"</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>multisession:
- args: function (..., workers = 8, envir = parent.frame())
- tweaked: TRUE
- call: plan("multisession", workers = n_cores)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2 theme</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(ggmin<span class="sc">::</span><span class="fu">theme_powerpoint</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bioproject <span class="ot">&lt;-</span> <span class="st">"PRJNA547712"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>project <span class="ot">&lt;-</span> <span class="st">"kim2020_Hypoth-dev"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>cb_fpr <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>low_cutoff_gene <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>high_cutoff_gene <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>high_cutoff_gene <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>low_cutoff_umis <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>low_cutoff_umis <span class="ot">&lt;-</span> <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>high_cutoff_umis <span class="ot">&lt;-</span> <span class="dv">25000</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>high_cutoff_pc_mt <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>high_cutoff_pc_ribo <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>high_cutoff_pc_hb <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>high_cutoff_doublet_score <span class="ot">&lt;-</span> <span class="fl">0.33</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>high_cutoff_complexity <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>connectivity_model <span class="ot">&lt;-</span> <span class="st">"min_tree"</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>metric <span class="ot">&lt;-</span> <span class="st">"euclidean"</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>signature <span class="ot">&lt;-</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="load-kim-dw-et-al-2020" class="level2">
<h2 class="anchored" data-anchor-id="load-kim-dw-et-al-2020">Load Kim DW et al 2020</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>anndata <span class="ot">&lt;-</span> sc<span class="sc">$</span><span class="fu">read</span>(<span class="fu">here</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"kim2020_combined.h5ad"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="convert-adata-object-to-r-anndatar6-object." class="level3">
<h3 class="anchored" data-anchor-id="convert-adata-object-to-r-anndatar6-object.">Convert adata object to R AnnDataR6 object.</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>adata <span class="ot">&lt;-</span> <span class="fu">py_to_r</span>(anndata)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(adata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "AnnDataR6" "R6"       </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(adata<span class="sc">$</span>X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dgRMatrix"
attr(,"package")
[1] "Matrix"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>adata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AnnData object with n_obs × n_vars = 128006 × 27998
    obs: 'bc_name', 'orig.ident', 'nCount_RNA', 'nFeature_RNA', 'X1', 'X', 'Y', 'Z', 'Age', 'Cluster'
    var: '_index', 'features'</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>srt_path <span class="ot">&lt;-</span> <span class="fu">here</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">"%s-whole_dataset-simple.h5Seurat"</span>, bioproject)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>expr_mtx <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(adata<span class="sc">$</span>X))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(expr_mtx) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(adata<span class="sc">$</span>X)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(expr_mtx) <span class="ot">&lt;-</span> adata<span class="sc">$</span>var<span class="sc">$</span>features</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  expr_mtx,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">assay =</span> <span class="st">"RNA"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">project =</span> <span class="st">"kim2020_Hypoth_dev"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">meta.data =</span> <span class="fu">as.data.frame</span>(adata<span class="sc">$</span>obs)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>X_umap <span class="ot">&lt;-</span> adata<span class="sc">$</span>obs <span class="sc">|&gt;</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(X, Y) <span class="sc">|&gt;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X_umap) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"UMAP_1"</span>, <span class="st">"UMAP_2"</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(X_umap) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(expr_mtx)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>srt[[<span class="st">"umap"</span>]] <span class="ot">&lt;-</span> <span class="fu">CreateDimReducObject</span>(<span class="at">embeddings =</span> X_umap, <span class="at">key =</span> <span class="st">"umap_"</span>, <span class="at">assay =</span> <span class="fu">DefaultAssay</span>(srt))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="fu">Idents</span>(srt) <span class="ot">&lt;-</span> <span class="st">"age"</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">Store_Palette_Seurat</span>(<span class="at">seurat_object =</span> srt, <span class="at">palette =</span> <span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">name =</span> <span class="st">"Spectral"</span>)), <span class="at">palette_name =</span> <span class="st">"expr_Colour_Pal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="load-romanov-et-al-2020" class="level2">
<h2 class="anchored" data-anchor-id="load-romanov-et-al-2020">Load Romanov et al 2020</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(srt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>An object of class Seurat 
27998 features across 128006 samples within 1 assay 
Active assay: RNA (27998 features, 0 variable features)
 1 layer present: counts
 1 dimensional reduction calculated: umap</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"/data/1_heteroAstrocytes/PRJNA548917/old/oldCCA_nae_srt.rds"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="ot">&lt;-</span> <span class="fu">UpdateSeuratObject</span>(rar2020.srt.pub)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Idents</span>(rar2020.srt.pub) <span class="ot">&lt;-</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(rar2020.srt.pub<span class="sc">$</span>wtree,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Consistent colours and clusters names</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>colours_wtree <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">read_lines</span>(<span class="fu">here</span>(data_dir, <span class="st">"colours_wtree.tsv"</span>)), <span class="dv">1</span><span class="sc">:</span><span class="dv">45</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub<span class="sc">$</span>age <span class="ot">&lt;-</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Cells</span>(rar2020.srt.pub) <span class="sc">|&gt;</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split</span>(<span class="at">pattern =</span> <span class="st">":"</span>, <span class="at">simplify =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  .[, <span class="dv">1</span>] <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split_fixed</span>(<span class="at">pattern =</span> <span class="st">"_"</span>, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  .[, <span class="dv">3</span>]</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rar2020.srt.pub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>An object of class Seurat 
24340 features across 51199 samples within 1 assay 
Active assay: RNA (24340 features, 3500 variable features)
 3 layers present: counts, data, scale.data
 3 dimensional reductions calculated: pca, tsne, umap</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(rar2020.srt.pub<span class="sc">@</span>meta.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 51,199
Columns: 20
$ nGene            &lt;int&gt; 1652, 782, 447, 1706, 1106, 894, 727, 734, 669, 617, …
$ nUMI             &lt;dbl&gt; 2787, 1090, 544, 2709, 1817, 1220, 995, 1036, 920, 86…
$ orig.ident       &lt;fct&gt; Hypothalamus, Hypothalamus, Hypothalamus, Hypothalamu…
$ res.0.2          &lt;chr&gt; "23", "23", "23", "23", "23", "23", "23", "23", "23",…
$ res.0.4          &lt;chr&gt; "34", "34", "34", "34", "34", "34", "34", "34", "34",…
$ res.0.8          &lt;chr&gt; "42", "42", "42", "42", "42", "42", "42", "42", "42",…
$ res.1.2          &lt;chr&gt; "47", "47", "47", "47", "47", "47", "47", "47", "47",…
$ res.2            &lt;chr&gt; "54", "54", "54", "54", "54", "54", "54", "54", "54",…
$ tree.ident       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ pro_Inter        &lt;chr&gt; "41", "41", "41", "41", "41", "41", "41", "41", "41",…
$ pro_Enter        &lt;chr&gt; "41", "41", "41", "41", "41", "41", "41", "41", "41",…
$ tree_final       &lt;fct&gt; 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 1…
$ subtree          &lt;fct&gt; 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 4…
$ prim_walktrap    &lt;fct&gt; 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3…
$ umi_per_gene     &lt;dbl&gt; 1.687046, 1.393862, 1.217002, 1.587925, 1.642857, 1.3…
$ log_umi_per_gene &lt;dbl&gt; 0.22712693, 0.14421974, 0.08529138, 0.20082998, 0.215…
$ nCount_RNA       &lt;dbl&gt; 2787, 1090, 544, 2709, 1817, 1220, 995, 1036, 920, 86…
$ nFeature_RNA     &lt;int&gt; 1652, 782, 447, 1706, 1106, 894, 727, 734, 669, 617, …
$ wtree            &lt;fct&gt; 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3…
$ age              &lt;chr&gt; "P23", "3P2", "3P2", "P2", "P2", "P2", "P2", "P2", "P…</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">Idents</span>(rar2020.srt.pub))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 2344  8146   395   402  3234   712   552   374   259   952 13727  1615   765 
   14    15    16    17    18    19    20    21    22    23    24    25    26 
  832  1244   792   590   808  2486  1683   628  1039  1750   292   394   547 
   27    28    29    30    31    32    33    34    35    36    37    38    39 
  391   407   507    93    81   402   143   701   222   353   324    73    78 
   40    41    42    43    44    45 
  328   190    73    37   179    55 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="sc">%&lt;&gt;%</span> <span class="fu">RenameIdents</span>(<span class="at">object =</span> ., <span class="st">`</span><span class="at">43</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"mneOXY"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="sc">%&lt;&gt;%</span> <span class="fu">RenameIdents</span>(<span class="at">object =</span> ., <span class="st">`</span><span class="at">26</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"mneVAS"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="sc">%&lt;&gt;%</span> <span class="fu">RenameIdents</span>(<span class="at">object =</span> ., <span class="st">`</span><span class="at">31</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"pneSS"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="sc">%&lt;&gt;%</span> <span class="fu">RenameIdents</span>(<span class="at">object =</span> ., <span class="st">`</span><span class="at">24</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"pneCRH"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="sc">%&lt;&gt;%</span> <span class="fu">RenameIdents</span>(<span class="at">object =</span> ., <span class="st">`</span><span class="at">15</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"pneTRH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub<span class="sc">$</span>stage <span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  rar2020.srt.pub<span class="sc">$</span>age <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Embryonic =</span> <span class="fu">c</span>(<span class="st">"E15"</span>, <span class="st">"E17"</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Neonatal =</span> <span class="fu">c</span>(<span class="st">"P0"</span>, <span class="st">"P2"</span>, <span class="st">"3P2"</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pubertal =</span> <span class="fu">c</span>(<span class="st">"1P10"</span>, <span class="st">"P10"</span>),</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adult =</span> <span class="fu">c</span>(<span class="st">"P23"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub<span class="sc">$</span>stage <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Embryonic"</span>, <span class="st">"Neonatal"</span>, <span class="st">"Pubertal"</span>, <span class="st">"Adult"</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub<span class="sc">$</span>stage <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["f"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Embryonic","2":"19503"},{"1":"Neonatal","2":"20316"},{"1":"Pubertal","2":"8965"},{"1":"Adult","2":"2415"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pvn <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> rar2020.srt.pub,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">idents =</span> <span class="fu">c</span>(</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mneOXY"</span>, <span class="st">"mneVAS"</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"pneSS"</span>, <span class="st">"pneCRH"</span>, <span class="st">"pneTRH"</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">invert =</span> <span class="cn">FALSE</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub<span class="sc">$</span>age <span class="ot">&lt;-</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">mapvalues</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> rar2020.srt.pub<span class="sc">$</span>age,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">c</span>(<span class="st">"E15"</span>, <span class="st">"E17"</span>, <span class="st">"P0"</span>, <span class="st">"P2"</span>, <span class="st">"3P2"</span>, <span class="st">"1P10"</span>, <span class="st">"P10"</span>, <span class="st">"P23"</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">c</span>(<span class="st">"E15"</span>, <span class="st">"E17"</span>, <span class="st">"P00"</span>, <span class="st">"P02"</span>, <span class="st">"P02"</span>, <span class="st">"P10"</span>, <span class="st">"P10"</span>, <span class="st">"P23"</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pvn<span class="sc">$</span>age <span class="ot">&lt;-</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  plyr<span class="sc">::</span><span class="fu">mapvalues</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> rar2020.srt.pvn<span class="sc">$</span>age,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">c</span>(<span class="st">"E15"</span>, <span class="st">"E17"</span>, <span class="st">"P0"</span>, <span class="st">"P2"</span>, <span class="st">"3P2"</span>, <span class="st">"1P10"</span>, <span class="st">"P10"</span>, <span class="st">"P23"</span>),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">c</span>(<span class="st">"E15"</span>, <span class="st">"E17"</span>, <span class="st">"P00"</span>, <span class="st">"P02"</span>, <span class="st">"P02"</span>, <span class="st">"P10"</span>, <span class="st">"P10"</span>, <span class="st">"P23"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub<span class="sc">$</span>age <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["f"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"E15","2":"8290"},{"1":"E17","2":"11213"},{"1":"P00","2":"7492"},{"1":"P02","2":"12824"},{"1":"P10","2":"8965"},{"1":"P23","2":"2415"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  rar2020.srt.pub,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">features =</span> <span class="fu">c</span>(neurotrans, cnbn),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> F,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">blend =</span> F,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">raster.dpi =</span> <span class="fu">c</span>(<span class="dv">1024</span>, <span class="dv">1024</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">split.by =</span> <span class="st">"age"</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-feature-cb-romanov2020-1.png" class="img-fluid figure-img" width="5400"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sbs_mtx <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  rar2020.srt.pub<span class="sc">@</span>assays<span class="sc">$</span>RNA<span class="sc">@</span>data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sbs_mtx) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rar2020.srt.pub)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter features</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>filt_low_genes <span class="ot">&lt;-</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(sbs_mtx) <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  .[. <span class="sc">&gt;</span> <span class="fu">quantile</span>(., <span class="fl">0.4</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>sbs_mtx <span class="sc">%&lt;&gt;%</span> .[, filt_low_genes]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>min_filt_vector2 <span class="ot">&lt;-</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  sbs_mtx <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(filt_low_genes)) <span class="sc">%&gt;%</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">quantile</span>(.x, .<span class="dv">005</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(as.double) <span class="sc">%&gt;%</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  .[filt_low_genes]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare table of intersection sets analysis</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>content_sbs_mtx <span class="ot">&lt;-</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  (sbs_mtx <span class="sc">&gt;</span> min_filt_vector2) <span class="sc">%&gt;%</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.numeric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(content_sbs_mtx),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-all-romanov2020-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(content_sbs_mtx),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">15</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">20</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-not-grouped-e-cb-all-romanov2020-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sbs_mtx_full <span class="ot">&lt;-</span> content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">any_of</span>(<span class="fu">c</span>(neurotrans, cnbn))) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(rar2020.srt.pub<span class="sc">@</span>meta.data)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>sbs_mtx_full <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 51,199
Columns: 38
$ Slc17a6          &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Slc17a8          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Slc1a1           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Slc1a2           &lt;dbl&gt; 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Slc1a6           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Gad1             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,…
$ Slc32a1          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Slc6a1           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Cnr1             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Gpr55            &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Dagla            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Daglb            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Mgll             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Faah             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Napepld          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Gde1             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ Pparg            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ nGene            &lt;int&gt; 1652, 782, 447, 1706, 1106, 894, 727, 734, 669, 617, …
$ nUMI             &lt;dbl&gt; 2787, 1090, 544, 2709, 1817, 1220, 995, 1036, 920, 86…
$ orig.ident       &lt;fct&gt; Hypothalamus, Hypothalamus, Hypothalamus, Hypothalamu…
$ res.0.2          &lt;chr&gt; "23", "23", "23", "23", "23", "23", "23", "23", "23",…
$ res.0.4          &lt;chr&gt; "34", "34", "34", "34", "34", "34", "34", "34", "34",…
$ res.0.8          &lt;chr&gt; "42", "42", "42", "42", "42", "42", "42", "42", "42",…
$ res.1.2          &lt;chr&gt; "47", "47", "47", "47", "47", "47", "47", "47", "47",…
$ res.2            &lt;chr&gt; "54", "54", "54", "54", "54", "54", "54", "54", "54",…
$ tree.ident       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
$ pro_Inter        &lt;chr&gt; "41", "41", "41", "41", "41", "41", "41", "41", "41",…
$ pro_Enter        &lt;chr&gt; "41", "41", "41", "41", "41", "41", "41", "41", "41",…
$ tree_final       &lt;fct&gt; 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 1…
$ subtree          &lt;fct&gt; 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 4…
$ prim_walktrap    &lt;fct&gt; 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3…
$ umi_per_gene     &lt;dbl&gt; 1.687046, 1.393862, 1.217002, 1.587925, 1.642857, 1.3…
$ log_umi_per_gene &lt;dbl&gt; 0.22712693, 0.14421974, 0.08529138, 0.20082998, 0.215…
$ nCount_RNA       &lt;dbl&gt; 2787, 1090, 544, 2709, 1817, 1220, 995, 1036, 920, 86…
$ nFeature_RNA     &lt;int&gt; 1652, 782, 447, 1706, 1106, 894, 727, 734, 669, 617, …
$ wtree            &lt;fct&gt; 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3…
$ age              &lt;chr&gt; "P23", "P02", "P02", "P02", "P02", "P02", "P02", "P02…
$ stage            &lt;ord&gt; Adult, Neonatal, Neonatal, Neonatal, Neonatal, Neonat…</code></pre>
</div>
</div>
</section>
<section id="prepare-query-mapping-between-datasets" class="level2">
<h2 class="anchored" data-anchor-id="prepare-query-mapping-between-datasets">Prepare query mapping between datasets</h2>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(srt)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(srt, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">3000</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># all.genes &lt;- rownames(srt)</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># srt &lt;- ScaleData(srt, features = all.genes)</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(srt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hypoth.anchors <span class="ot">&lt;-</span> <span class="fu">FindTransferAnchors</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference =</span> rar2020.srt.pub, <span class="at">query =</span> srt, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference.reduction =</span> <span class="st">"pca"</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">TransferData</span>(<span class="at">anchorset =</span> hypoth.anchors, <span class="at">refdata =</span> rar2020.srt.pub<span class="sc">$</span>wtree, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">AddMetaData</span>(srt, <span class="at">metadata =</span> predictions)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(srt<span class="sc">$</span>predicted.id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     1     10     11     12     13     15     16     17     19      2     20 
  3700      1   2198    225    545     58    218     19 100308   9886    924 
    22     23     26     27     28     29      3     38      4      5      6 
   163     11    115     24     76    481    951     49    156   2895   4756 
     7      8      9 
   199     47      1 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pub <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(rar2020.srt.pub, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">reduction =</span> <span class="st">"pca"</span>, <span class="at">return.model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">IntegrateEmbeddings</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">anchorset =</span> hypoth.anchors, <span class="at">reference =</span> rar2020.srt.pub, <span class="at">query =</span> srt,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">new.reduction.name =</span> <span class="st">"ref.pca"</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">ProjectUMAP</span>(</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">query =</span> srt, <span class="at">query.reduction =</span> <span class="st">"ref.pca"</span>, <span class="at">reference =</span> rar2020.srt.pub,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">reference.reduction =</span> <span class="st">"pca"</span>, <span class="at">reduction.model =</span> <span class="st">"umap"</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Idents</span>(srt) <span class="ot">&lt;-</span> srt<span class="sc">$</span>Cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(rar2020.srt.pub,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">"umap"</span>, <span class="at">group.by =</span> <span class="st">"wtree"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label.size =</span> <span class="dv">3</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">NoLegend</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Reference annotations"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(srt,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">"ref.umap"</span>, <span class="at">group.by =</span> <span class="st">"Cluster"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label.size =</span> <span class="dv">3</span>, <span class="at">repel =</span> <span class="cn">TRUE</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">NoLegend</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Query transferred Embedding"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-reference-umap-transfered-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">FeaturePlot_scCustom</span>(rar2020.srt.pub,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">"umap"</span>, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Oxt"</span>, <span class="st">"Avp"</span>, <span class="st">"Sst"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label.size =</span> <span class="dv">2</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">num_columns =</span> <span class="dv">5</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">*</span> <span class="fu">NoLegend</span>()</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">FeaturePlot_scCustom</span>(srt,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">"ref.umap"</span>, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Oxt"</span>, <span class="st">"Avp"</span>, <span class="st">"Sst"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>), <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">label.size =</span> <span class="dv">2</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">num_columns =</span> <span class="dv">5</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">*</span> <span class="fu">NoLegend</span>()</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">/</span> p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-reference-umap-transfered-genes-1.png" class="img-fluid figure-img" width="5400"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot_scCustom</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  srt,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">"ref.umap"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">split.by =</span> <span class="st">"Age"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_columns =</span> <span class="dv">4</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/ref-embedding-split-age-1.png" class="img-fluid figure-img" width="6300"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>srt<span class="sc">$</span>stage <span class="ot">&lt;-</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  srt<span class="sc">$</span>Age <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  forcats<span class="sc">::</span><span class="fu">fct_collapse</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Embryonic =</span> <span class="fu">c</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"E10"</span>, <span class="st">"E11"</span>, <span class="st">"E12"</span>, <span class="st">"E13"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"E14"</span>, <span class="st">"E15"</span>, <span class="st">"E16"</span>, <span class="st">"E18"</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Neonatal =</span> <span class="fu">c</span>(<span class="st">"P4"</span>, <span class="st">"P8"</span>),</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Pubertal =</span> <span class="fu">c</span>(<span class="st">"P14"</span>),</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Adult =</span> <span class="fu">c</span>(<span class="st">"P45"</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>srt<span class="sc">$</span>stage <span class="sc">%&lt;&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Embryonic"</span>, <span class="st">"Neonatal"</span>, <span class="st">"Pubertal"</span>, <span class="st">"Adult"</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot_scCustom</span>(</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  srt,</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">reduction =</span> <span class="st">"ref.umap"</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">split.by =</span> <span class="st">"stage"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_columns =</span> <span class="dv">4</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/ref-embedding-split-stage-1.png" class="img-fluid figure-img" width="6300"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">here</span>(data_dir, <span class="st">"kim2020_pvn_neurons.txt"</span>))) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(<span class="at">object =</span> srt, <span class="at">reduction =</span> <span class="st">"ref.umap"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  srt <span class="ot">&lt;-</span> <span class="fu">CellSelector</span>(<span class="at">plot =</span> plot, <span class="at">object =</span> srt, <span class="at">ident =</span> <span class="st">"SelectedCells"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  selected_cells <span class="ot">&lt;-</span> <span class="fu">Cells</span>(<span class="fu">subset</span>(srt, <span class="at">idents =</span> <span class="st">"SelectedCells"</span>))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_lines</span>(selected_cells, <span class="at">file =</span> <span class="fu">here</span>(data_dir, <span class="st">"kim2020_pvn_neurons.txt"</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>selected_cells <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(<span class="fu">here</span>(data_dir, <span class="st">"kim2020_pvn_neurons.txt"</span>))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>srt <span class="ot">&lt;-</span> <span class="fu">subset</span>(srt, <span class="at">cells =</span> selected_cells)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>srt<span class="sc">@</span>meta.data <span class="ot">&lt;-</span> srt<span class="sc">@</span>meta.data <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">wtree =</span> predicted.id, <span class="at">age =</span> Age)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>srt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>An object of class Seurat 
27998 features across 4566 samples within 1 assay 
Active assay: RNA (27998 features, 3000 variable features)
 3 layers present: counts, data, scale.data
 3 dimensional reductions calculated: umap, ref.pca, ref.umap</code></pre>
</div>
</div>
</section>
<section id="intersection-sets-analysis" class="level2">
<h2 class="anchored" data-anchor-id="intersection-sets-analysis">Intersection sets analysis</h2>
<section id="pvn-neurons-from-kim-et-al.-2020-nature-communications" class="level3">
<h3 class="anchored" data-anchor-id="pvn-neurons-from-kim-et-al.-2020-nature-communications">PVN Neurons from Kim et al.&nbsp;2020, Nature Communications</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot_scCustom</span>(srt, <span class="at">reduction =</span> <span class="st">"ref.umap"</span>, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Oxt"</span>, <span class="st">"Avp"</span>, <span class="st">"Sst"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>), <span class="at">split.by =</span> <span class="st">"stage"</span>, <span class="at">label =</span> F, <span class="at">num_columns =</span> <span class="dv">4</span>) <span class="sc">*</span> <span class="fu">NoLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-reference-umap-transfered-genes-split-by-stages-1.png" class="img-fluid figure-img" width="5400"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot_scCustom</span>(srt, <span class="at">reduction =</span> <span class="st">"ref.umap"</span>, <span class="at">features =</span> <span class="fu">c</span>(cnbn), <span class="at">split.by =</span> <span class="st">"stage"</span>, <span class="at">label =</span> F, <span class="at">num_columns =</span> <span class="dv">4</span>) <span class="sc">*</span> <span class="fu">NoLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-reference-umap-feature-cb-split-by-stages-1.png" class="img-fluid figure-img" width="5400"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sbs_mtx <span class="ot">&lt;-</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  srt<span class="sc">@</span>assays<span class="sc">$</span>RNA<span class="sc">@</span>layers<span class="sc">$</span>data <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sbs_mtx) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(srt)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sbs_mtx) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(srt)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter features</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>filt_low_genes <span class="ot">&lt;-</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(sbs_mtx) <span class="sc">%&gt;%</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  .[. <span class="sc">&gt;</span> <span class="fu">quantile</span>(., <span class="fl">0.4</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>sbs_mtx <span class="sc">%&lt;&gt;%</span> .[, filt_low_genes]</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>min_filt_vector2 <span class="ot">&lt;-</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  sbs_mtx <span class="sc">%&gt;%</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(filt_low_genes)) <span class="sc">%&gt;%</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">quantile</span>(.x, .<span class="dv">005</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(as.double) <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  .[filt_low_genes]</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare table of intersection sets analysis</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>content_sbs_mtx_kim <span class="ot">&lt;-</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  (sbs_mtx <span class="sc">&gt;</span> min_filt_vector2) <span class="sc">%&gt;%</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>    srt<span class="sc">@</span>meta.data <span class="sc">|&gt;</span> <span class="fu">select</span>(wtree, age, stage)</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="all" class="level4">
<h4 class="anchored" data-anchor-id="all">All</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(content_sbs_mtx_kim),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)],</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-kim2020-pvn-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="embryonic" class="level4">
<h4 class="anchored" data-anchor-id="embryonic">Embryonic</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_kim <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Embryonic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)],</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> F</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-kim2020-pvn-Embryonic-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="neonatal" class="level4">
<h4 class="anchored" data-anchor-id="neonatal">Neonatal</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_kim <span class="sc">|&gt;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Neonatal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)]</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)],</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> F</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-kim2020-pvn-Neonatal-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pubertal" class="level4">
<h4 class="anchored" data-anchor-id="pubertal">Pubertal</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_kim <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Pubertal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)],</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-kim2020-pvn-Pubertal-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adult" class="level4">
<h4 class="anchored" data-anchor-id="adult">Adult</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_kim <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Adult"</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)]</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)],</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> F</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-kim2020-pvn-Adult-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pvn-neurons-from-romanov-et-al.-2020-nature" class="level3">
<h3 class="anchored" data-anchor-id="pvn-neurons-from-romanov-et-al.-2020-nature">PVN Neurons from Romanov et al.&nbsp;2020, Nature</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot_scCustom</span>(rar2020.srt.pvn, <span class="at">reduction =</span> <span class="st">"umap"</span>, <span class="at">features =</span> <span class="fu">c</span>(cnbn), <span class="at">split.by =</span> <span class="st">"stage"</span>, <span class="at">label =</span> F, <span class="at">num_columns =</span> <span class="dv">4</span>) <span class="sc">*</span> <span class="fu">NoLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-romanov2020-pvn-feature-cb-split-by-stages-1.png" class="img-fluid figure-img" width="5400"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  rar2020.srt.pvn,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">features =</span> <span class="fu">c</span>(cnbn),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> F,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">blend =</span> F,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">raster.dpi =</span> <span class="fu">c</span>(<span class="dv">1024</span>, <span class="dv">1024</span>),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">split.by =</span> <span class="st">"age"</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-feature-cb-romanov2020-pvn-1.png" class="img-fluid figure-img" width="5400"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>sbs_mtx <span class="ot">&lt;-</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  rar2020.srt.pvn<span class="sc">@</span>assays<span class="sc">$</span>RNA<span class="sc">@</span>data <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter features</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>filt_low_genes <span class="ot">&lt;-</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(sbs_mtx) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  .[. <span class="sc">&gt;</span> <span class="fu">quantile</span>(., <span class="fl">0.4</span>)] <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>()</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>sbs_mtx <span class="sc">%&lt;&gt;%</span> .[, filt_low_genes]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>min_filt_vector2 <span class="ot">&lt;-</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  sbs_mtx <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(filt_low_genes)) <span class="sc">%&gt;%</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="at">.fns =</span> <span class="sc">~</span> <span class="fu">quantile</span>(.x, .<span class="dv">005</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.list</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(as.double) <span class="sc">%&gt;%</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">simplify</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  .[filt_low_genes]</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare table of intersection sets analysis</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>content_sbs_mtx_romanov <span class="ot">&lt;-</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  (sbs_mtx <span class="sc">&gt;</span> min_filt_vector2) <span class="sc">%&gt;%</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_all</span>(as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    rar2020.srt.pvn<span class="sc">@</span>meta.data <span class="sc">|&gt;</span> <span class="fu">select</span>(wtree, age, stage)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="all-1" class="level4">
<h4 class="anchored" data-anchor-id="all-1">All</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(content_sbs_mtx_romanov),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)],</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-romanov2020-pvn-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="embryonic-1" class="level4">
<h4 class="anchored" data-anchor-id="embryonic-1">Embryonic</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_romanov <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Embryonic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)]</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)],</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-romanov2020-pvn-Embryonic-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="neonatal-1" class="level4">
<h4 class="anchored" data-anchor-id="neonatal-1">Neonatal</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_romanov <span class="sc">|&gt;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Neonatal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)]</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)],</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-romanov2020-pvn-Neonatal-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pubertal-1" class="level4">
<h4 class="anchored" data-anchor-id="pubertal-1">Pubertal</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_romanov <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Pubertal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)],</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-romanov2020-pvn-Pubertal-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adult-1" class="level4">
<h4 class="anchored" data-anchor-id="adult-1">Adult</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_romanov <span class="sc">|&gt;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Adult"</span>) <span class="sc">|&gt;</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)]</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)],</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-romanov2020-pvn-Adult-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pvn-neurons-from-both-datasets-joined" class="level3">
<h3 class="anchored" data-anchor-id="pvn-neurons-from-both-datasets-joined">PVN Neurons from both datasets joined</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare table of intersection sets analysis</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>to_select <span class="ot">&lt;-</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(cnbn, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>, <span class="st">"Avp"</span>, <span class="st">"Sst"</span>, <span class="st">"wtree"</span>, <span class="st">"age"</span>, <span class="st">"stage"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_kim)] <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx_romanov)]</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>content_sbs_mtx <span class="ot">&lt;-</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_kim <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">all_of</span>(to_select)),</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx_romanov <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">all_of</span>(to_select))</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="all-2" class="level4">
<h4 class="anchored" data-anchor-id="all-2">All</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(content_sbs_mtx),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group.by =</span> <span class="st">"sets"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="embryonic-2" class="level4">
<h4 class="anchored" data-anchor-id="embryonic-2">Embryonic</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Embryonic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Embryonic-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Embryonic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Embryonic-f2-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Embryonic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Embryonic-f3-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Embryonic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Embryonic-f4-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="neonatal-2" class="level4">
<h4 class="anchored" data-anchor-id="neonatal-2">Neonatal</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Neonatal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Neonatal-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Neonatal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Neonatal-f2-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Neonatal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Neonatal-f3-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Neonatal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Neonatal-f4-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pubertal-2" class="level4">
<h4 class="anchored" data-anchor-id="pubertal-2">Pubertal</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Pubertal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Pubertal-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Pubertal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Pubertal-f2-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Pubertal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Pubertal-f3-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Pubertal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Pubertal-f4-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adult-2" class="level4">
<h4 class="anchored" data-anchor-id="adult-2">Adult</h4>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Adult"</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(cnbn) <span class="sc">%&gt;%</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Adult-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Adult"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Cnr1"</span>, <span class="st">"Cnr2"</span>, <span class="st">"Gpr55"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Adult-f2-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Adult"</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Dagla"</span>, <span class="st">"Daglb"</span>, <span class="st">"Mgll"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Adult-f3-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="1.214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">upset</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    content_sbs_mtx <span class="sc">|&gt;</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(stage <span class="sc">==</span> <span class="st">"Adult"</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span> .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)]</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">order.by =</span> <span class="st">"freq"</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">3</span>,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets.x.label =</span> <span class="st">"Number of cells"</span>,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number.angles =</span> <span class="dv">0</span>,</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">point.size =</span> <span class="fl">3.5</span>, <span class="at">line.size =</span> <span class="dv">2</span>,</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.6</span>, <span class="dv">2</span>, <span class="fl">1.3</span>, <span class="dv">2</span>, <span class="fl">1.1</span>),</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsets =</span> <span class="dv">30</span>,</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">nintersects =</span> <span class="dv">30</span>,</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">sets =</span> <span class="fu">c</span>(<span class="st">"Napepld"</span>, <span class="st">"Gde1"</span>, <span class="st">"Faah"</span>, <span class="st">"Oxt"</span>, <span class="st">"Crh"</span>, <span class="st">"Trh"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    .[. <span class="sc">%in%</span> <span class="fu">colnames</span>(content_sbs_mtx)],</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">empty.intersections =</span> <span class="cn">NULL</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/upset-group-e-cb-pvn-Adult-f4-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="contingency-tables" class="level3">
<h3 class="anchored" data-anchor-id="contingency-tables">Contingency tables</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pvn<span class="sc">$</span>age <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["f"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"E15","2":"332"},{"1":"E17","2":"609"},{"1":"P00","2":"368"},{"1":"P02","2":"378"},{"1":"P10","2":"447"},{"1":"P23","2":"67"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>rar2020.srt.pvn<span class="sc">$</span>stage <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["f"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Embryonic","2":"941"},{"1":"Neonatal","2":"746"},{"1":"Pubertal","2":"447"},{"1":"Adult","2":"67"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>srt<span class="sc">$</span>age <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["f"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"E10","2":"22"},{"1":"E11","2":"169"},{"1":"E12","2":"374"},{"1":"E13","2":"292"},{"1":"E14","2":"541"},{"1":"E15","2":"445"},{"1":"E16","2":"657"},{"1":"E18","2":"369"},{"1":"P14","2":"216"},{"1":"P4","2":"199"},{"1":"P45","2":"737"},{"1":"P8","2":"545"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>srt<span class="sc">$</span>stage <span class="sc">%&gt;%</span> forcats<span class="sc">::</span><span class="fu">fct_count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["f"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Embryonic","2":"2869"},{"1":"Neonatal","2":"744"},{"1":"Pubertal","2":"216"},{"1":"Adult","2":"737"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="integration-of-pvn-neurons-from-both-datasets" class="level2">
<h2 class="anchored" data-anchor-id="integration-of-pvn-neurons-from-both-datasets">Integration of PVN neurons from both datasets</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-fig.asp="0.309">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-integrated-pvn-neurons-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-integrated-pvn-split-1.png" class="img-fluid figure-img" width="2700"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-integrated-pvn-clusters-1.png" class="img-fluid figure-img" width="4200"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  srt.pvn.integr,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">features =</span> <span class="fu">c</span>(cnbn),</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> T,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">blend =</span> F,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">order =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">raster.dpi =</span> <span class="fu">c</span>(<span class="dv">1024</span>, <span class="dv">1024</span>),</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">split.by =</span> <span class="st">"stage"</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plot-feature-cb-pvn-both-1.png" class="img-fluid figure-img" width="9600"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Idents(srt.pvn.integr) &lt;- factor(srt.pvn.integr$wtree)</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_markers_pvn_wtree_final &lt;- FindAllMarkers(srt.pvn.integr,</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   assay = "SCT",</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   test.use = "wilcox",</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   logfc.threshold = 0.05,</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   min.pct = 0.05,</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   random.seed = reseed,</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   return.thresh = 0.01</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># all_markers_pvn_wtree_final %&gt;%</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(cluster) %&gt;%</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(p_val_adj &lt; 0.01) %&gt;%</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   slice_max(n = 4, order_by = avg_logFC)</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co"># readr::write_csv(all_markers_wtree_final,</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   path = here::here(</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     tables_dir,</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     "all-markers_pvn_wilcox-test-sct.csv"</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co"># all_markers_pvn_wtree_final &lt;-</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   readr::read_csv(here::here(</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     tables_dir,</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="co">#     "all-markers_pvn_wilcox-test-sct.csv"</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   ))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="dotplots" class="level1">
<h1>Dotplots</h1>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>goi <span class="ot">&lt;-</span> <span class="fu">c</span>(cnbn)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Idents</span>(srt) <span class="ot">&lt;-</span> <span class="st">"age"</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot_scCustom</span>(<span class="at">seurat_object =</span> srt.pvn.integr, <span class="at">colors_use =</span> <span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">alpha =</span> .<span class="dv">75</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">option =</span> <span class="st">"E"</span>), <span class="at">features =</span> goi[goi <span class="sc">%in%</span> <span class="fu">rownames</span>(srt)], <span class="at">flip_axes =</span> T, <span class="at">x_lab_rotate =</span> <span class="cn">TRUE</span>, <span class="at">dot.scale =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plt-dotplot-dendrogram-genes-npr-1.png" class="img-fluid figure-img" width="1800"></p>
</figure>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(srt, <span class="at">features =</span> goi[goi <span class="sc">%in%</span> <span class="fu">rownames</span>(srt)], <span class="at">dot.scale =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-endo-cb_files/figure-html/plt-dotplot-dendrogram-genes-npr-2.png" class="img-fluid figure-img" width="1800"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.0 (2024-04-24)
 os       Ubuntu 22.04.4 LTS
 system   x86_64, linux-gnu
 ui       X11
 language en_US:en
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       Etc/UTC
 date     2024-11-19
 pandoc   3.1.11.1 @ /home/etretiakov/micromamba/bin/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 package              * version     date (UTC) lib source
 abind                  1.4-8       2024-09-12 [2] RSPM (R 4.4.0)
 anndata              * 0.7.5.6     2023-03-17 [2] RSPM (R 4.4.0)
 assertthat             0.2.1       2019-03-21 [2] RSPM (R 4.4.0)
 base64enc              0.1-3       2015-07-28 [2] RSPM (R 4.4.0)
 bayestestR             0.13.2      2024-02-12 [2] RSPM (R 4.4.0)
 beeswarm               0.4.0       2021-06-01 [2] RSPM (R 4.4.0)
 Biobase                2.64.0      2024-04-30 [2] RSPM (R 4.4.0)
 BiocGenerics           0.50.0      2024-04-30 [2] RSPM (R 4.4.0)
 BiocManager            1.30.23     2024-05-04 [2] RSPM (R 4.4.0)
 bit                    4.0.5       2022-11-15 [2] RSPM (R 4.4.0)
 bit64                  4.0.5       2020-08-30 [2] RSPM (R 4.4.0)
 circlize               0.4.16      2024-06-19 [2] Github (jokergoo/circlize@9b21578)
 cli                    3.6.3       2024-06-21 [2] RSPM (R 4.4.0)
 cluster                2.1.6       2023-12-01 [2] RSPM (R 4.4.0)
 coda                   0.19-4.1    2024-01-31 [2] RSPM (R 4.4.0)
 codetools              0.2-20      2024-03-31 [2] RSPM (R 4.4.0)
 colorspace             2.1-1       2024-07-26 [2] RSPM (R 4.4.0)
 correlation            0.8.5       2024-06-16 [2] RSPM (R 4.4.0)
 cowplot              * 1.1.3       2024-01-22 [2] RSPM (R 4.4.0)
 crayon                 1.5.3       2024-06-20 [2] RSPM (R 4.4.0)
 data.table             1.16.0      2024-08-27 [2] RSPM (R 4.4.0)
 datawizard             0.11.0      2024-06-05 [2] RSPM (R 4.4.0)
 DelayedArray           0.30.1      2024-05-07 [2] RSPM (R 4.4.0)
 deldir                 2.0-4       2024-02-28 [2] RSPM (R 4.4.0)
 digest                 0.6.37      2024-08-19 [2] RSPM (R 4.4.0)
 dotCall64              1.1-1       2023-11-28 [2] RSPM (R 4.4.0)
 dplyr                * 1.1.4       2023-11-17 [2] RSPM (R 4.4.0)
 effectsize             0.8.8       2024-05-12 [2] RSPM (R 4.4.0)
 emmeans                1.10.2      2024-05-20 [2] RSPM (R 4.4.0)
 estimability           1.5.1       2024-05-12 [2] RSPM (R 4.4.0)
 evaluate               1.0.0       2024-09-17 [2] RSPM (R 4.4.0)
 fansi                  1.0.6       2023-12-08 [2] RSPM (R 4.4.0)
 farver                 2.1.2       2024-05-13 [2] RSPM (R 4.4.0)
 fastDummies            1.7.4       2024-08-16 [2] RSPM (R 4.4.0)
 fastmap                1.2.0       2024-05-15 [2] RSPM (R 4.4.0)
 fitdistrplus           1.2-1       2024-07-12 [2] RSPM (R 4.4.0)
 forcats              * 1.0.0       2023-01-29 [2] RSPM (R 4.4.0)
 future               * 1.34.0      2024-07-29 [2] RSPM (R 4.4.0)
 future.apply           1.11.2      2024-03-28 [2] RSPM (R 4.4.0)
 generics               0.1.3       2022-07-05 [2] RSPM (R 4.4.0)
 GenomeInfoDb           1.40.1      2024-05-24 [2] RSPM (R 4.4.0)
 GenomeInfoDbData       1.2.12      2024-06-19 [2] RSPM (R 4.4.0)
 GenomicRanges          1.56.1      2024-06-12 [2] RSPM (R 4.4.0)
 ggbeeswarm             0.7.2       2024-06-19 [2] Github (eclarke/ggbeeswarm@ce2da8a)
 ggmin                  0.0.0.9000  2024-06-19 [2] Github (sjessa/ggmin@8ada274)
 ggplot2              * 3.5.1       2024-04-23 [2] RSPM (R 4.4.0)
 ggprism                1.0.5       2024-06-19 [2] Github (csdaw/ggprism@b6e6c0e)
 ggrastr                1.0.2       2024-06-19 [2] Github (VPetukhov/ggrastr@50ca3e0)
 ggrepel                0.9.6       2024-09-20 [2] Github (slowkow/ggrepel@e94776b)
 ggridges               0.5.6       2024-01-23 [2] RSPM (R 4.4.0)
 ggstatsplot          * 0.12.3.9000 2024-06-19 [2] Github (IndrajeetPatil/ggstatsplot@d55f86a)
 glmGamPoi              1.16.0      2024-04-30 [2] RSPM (R 4.4.0)
 GlobalOptions          0.1.2       2020-06-10 [2] RSPM (R 4.4.0)
 globals                0.16.3      2024-03-08 [2] RSPM (R 4.4.0)
 glue                   1.7.0       2024-01-09 [2] RSPM (R 4.4.0)
 goftest                1.2-3       2021-10-07 [2] RSPM (R 4.4.0)
 gridExtra              2.3         2017-09-09 [2] RSPM (R 4.4.0)
 gtable                 0.3.5       2024-04-22 [2] RSPM (R 4.4.0)
 hdf5r                  1.3.10      2024-03-02 [2] RSPM (R 4.4.0)
 here                 * 1.0.1       2020-12-13 [2] RSPM (R 4.4.0)
 hms                    1.1.3       2023-03-21 [2] RSPM (R 4.4.0)
 htmltools              0.5.8.1     2024-04-04 [2] RSPM (R 4.4.0)
 htmlwidgets            1.6.4       2023-12-06 [2] RSPM (R 4.4.0)
 httpuv                 1.6.15      2024-03-26 [2] RSPM (R 4.4.0)
 httr                   1.4.7       2023-08-15 [2] RSPM (R 4.4.0)
 ica                    1.0-3       2022-07-08 [2] RSPM (R 4.4.0)
 igraph                 2.0.3       2024-03-13 [2] RSPM (R 4.4.0)
 insight                0.20.1      2024-06-11 [2] RSPM (R 4.4.0)
 IRanges                2.38.0      2024-04-30 [2] RSPM (R 4.4.0)
 irlba                  2.3.5.1     2022-10-03 [2] RSPM (R 4.4.0)
 janitor                2.2.0.9000  2024-06-19 [2] Github (sfirke/janitor@80cd1eb)
 jsonlite               1.8.8       2023-12-04 [2] RSPM (R 4.4.0)
 KernSmooth             2.23-24     2024-05-17 [2] RSPM (R 4.4.0)
 knitr                  1.48        2024-07-07 [2] RSPM (R 4.4.0)
 labeling               0.4.3       2023-08-29 [2] RSPM (R 4.4.0)
 later                  1.3.2       2023-12-06 [2] RSPM (R 4.4.0)
 lattice                0.22-6      2024-03-20 [2] RSPM (R 4.4.0)
 lazyeval               0.2.2       2019-03-15 [2] RSPM (R 4.4.0)
 leiden                 0.4.3.1     2023-11-17 [2] RSPM (R 4.4.0)
 lifecycle              1.0.4       2023-11-07 [2] RSPM (R 4.4.0)
 listenv                0.9.1       2024-01-29 [2] RSPM (R 4.4.0)
 lmtest                 0.9-40      2022-03-21 [2] RSPM (R 4.4.0)
 lubridate            * 1.9.3       2023-09-27 [2] RSPM (R 4.4.0)
 magrittr             * 2.0.3       2022-03-30 [2] RSPM (R 4.4.0)
 MASS                   7.3-61      2024-06-13 [2] RSPM (R 4.4.0)
 Matrix                 1.7-0       2024-04-26 [2] RSPM (R 4.4.0)
 MatrixGenerics         1.16.0      2024-04-30 [2] RSPM (R 4.4.0)
 matrixStats            1.4.1       2024-09-08 [2] RSPM (R 4.4.0)
 mime                   0.12        2021-09-28 [2] RSPM (R 4.4.0)
 miniUI                 0.1.1.1     2018-05-18 [2] RSPM (R 4.4.0)
 multcomp               1.4-25      2023-06-20 [2] RSPM (R 4.4.0)
 munsell                0.5.1       2024-04-01 [2] RSPM (R 4.4.0)
 mvtnorm                1.2-5       2024-05-21 [2] RSPM (R 4.4.0)
 nlme                   3.1-165     2024-06-06 [2] RSPM (R 4.4.0)
 paletteer              1.6.0       2024-01-21 [2] RSPM (R 4.4.0)
 parallelly             1.38.0      2024-07-27 [2] RSPM (R 4.4.0)
 parameters             0.21.7      2024-05-14 [2] RSPM (R 4.4.0)
 patchwork            * 1.3.0.9000  2024-09-20 [2] Github (thomasp85/patchwork@2695a9f)
 pbapply                1.7-2       2023-06-27 [2] RSPM (R 4.4.0)
 pillar                 1.9.0       2023-03-22 [2] RSPM (R 4.4.0)
 pkgconfig              2.0.3       2019-09-22 [2] RSPM (R 4.4.0)
 plotly                 4.10.4      2024-01-13 [2] RSPM (R 4.4.0)
 plyr                   1.8.9       2023-10-02 [2] RSPM (R 4.4.0)
 png                    0.1-8       2022-11-29 [2] RSPM (R 4.4.0)
 polyclip               1.10-7      2024-07-23 [2] RSPM (R 4.4.0)
 prismatic              1.1.2       2024-04-10 [2] RSPM (R 4.4.0)
 progressr              0.14.0      2023-08-10 [2] RSPM (R 4.4.0)
 promises               1.3.0       2024-04-05 [2] RSPM (R 4.4.0)
 purrr                * 1.0.2       2023-08-10 [2] RSPM (R 4.4.0)
 R.methodsS3            1.8.2       2022-06-13 [2] RSPM (R 4.4.0)
 R.oo                   1.26.0      2024-01-24 [2] RSPM (R 4.4.0)
 R.utils                2.12.3      2023-11-18 [2] RSPM (R 4.4.0)
 R6                     2.5.1       2021-08-19 [2] RSPM (R 4.4.0)
 RANN                   2.6.2       2024-08-25 [2] RSPM (R 4.4.0)
 RColorBrewer         * 1.1-3       2022-04-03 [2] RSPM (R 4.4.0)
 Rcpp                   1.0.13      2024-07-17 [2] RSPM (R 4.4.0)
 RcppAnnoy              0.0.22      2024-01-23 [2] RSPM (R 4.4.0)
 RcppHNSW               0.6.0       2024-02-04 [2] RSPM (R 4.4.0)
 readr                * 2.1.5       2024-01-10 [2] RSPM (R 4.4.0)
 rematch2               2.1.2       2020-05-01 [2] RSPM (R 4.4.0)
 remotes                2.5.0       2024-03-17 [2] RSPM (R 4.4.0)
 repr                   1.1.7       2024-03-22 [2] RSPM (R 4.4.0)
 reshape2               1.4.4       2020-04-09 [2] RSPM (R 4.4.0)
 reticulate           * 1.39.0      2024-09-05 [2] RSPM (R 4.4.0)
 rlang                  1.1.4       2024-06-04 [2] RSPM (R 4.4.0)
 rmarkdown              2.28        2024-08-17 [2] RSPM (R 4.4.0)
 ROCR                   1.0-11      2020-05-02 [2] RSPM (R 4.4.0)
 rprojroot              2.0.4       2023-11-05 [2] RSPM (R 4.4.0)
 RSpectra               0.16-2      2024-07-18 [2] RSPM (R 4.4.0)
 rstudioapi             0.16.0      2024-03-24 [2] RSPM (R 4.4.0)
 rsvd                   1.0.5       2021-04-16 [2] RSPM (R 4.4.0)
 Rtsne                  0.17        2023-12-07 [2] RSPM (R 4.4.0)
 S4Arrays               1.4.1       2024-05-20 [2] RSPM (R 4.4.0)
 S4Vectors              0.42.0      2024-04-30 [2] RSPM (R 4.4.0)
 sandwich               3.1-0       2023-12-11 [2] RSPM (R 4.4.0)
 scales                 1.3.0       2023-11-28 [2] RSPM (R 4.4.0)
 scattermore            1.2         2023-06-12 [2] RSPM (R 4.4.0)
 scCustomize          * 2.1.2       2024-06-19 [2] Github (samuel-marsh/scCustomize@fc7a282)
 sceasy               * 0.0.7       2024-06-19 [2] Github (cellgeni/sceasy@c1c0bf9)
 sctransform            0.4.1       2023-10-19 [2] RSPM (R 4.4.0)
 sessioninfo            1.2.2       2021-12-06 [2] RSPM (R 4.4.0)
 Seurat               * 5.1.0.9005  2024-09-20 [2] Github (satijalab/seurat@95de9dc)
 SeuratDisk           * 0.0.0.9021  2024-06-19 [2] Github (mojaveazure/seurat-disk@877d4e1)
 SeuratObject         * 5.0.99.9001 2024-09-20 [2] Github (satijalab/seurat-object@1a140c7)
 SeuratWrappers       * 0.3.5       2024-06-19 [2] Github (satijalab/seurat-wrappers@8d46d6c)
 shape                  1.4.6.1     2024-02-23 [2] RSPM (R 4.4.0)
 shiny                  1.9.1       2024-08-01 [2] RSPM (R 4.4.0)
 skimr                * 2.1.5       2024-06-19 [2] Github (ropensci/skimr@d5126aa)
 snakecase              0.11.1      2023-08-27 [2] RSPM (R 4.4.0)
 sp                   * 2.1-4       2024-04-30 [2] RSPM (R 4.4.0)
 spam                   2.10-0      2023-10-23 [2] RSPM (R 4.4.0)
 SparseArray            1.4.8       2024-05-24 [2] RSPM (R 4.4.0)
 spatstat.data          3.1-2       2024-06-21 [2] RSPM (R 4.4.0)
 spatstat.explore       3.3-2       2024-08-21 [2] RSPM (R 4.4.0)
 spatstat.geom          3.3-3       2024-09-18 [2] RSPM (R 4.4.0)
 spatstat.random        3.3-2       2024-09-18 [2] RSPM (R 4.4.0)
 spatstat.sparse        3.1-0       2024-06-21 [2] RSPM (R 4.4.0)
 spatstat.univar        3.0-1       2024-09-05 [2] RSPM (R 4.4.0)
 spatstat.utils         3.1-0       2024-08-17 [2] RSPM (R 4.4.0)
 statsExpressions       1.5.4       2024-03-20 [2] RSPM (R 4.4.0)
 stringi                1.8.4       2024-05-06 [2] RSPM (R 4.4.0)
 stringr              * 1.5.1       2023-11-14 [2] RSPM (R 4.4.0)
 SummarizedExperiment   1.34.0      2024-05-01 [2] RSPM (R 4.4.0)
 survival               3.7-0       2024-06-05 [2] RSPM (R 4.4.0)
 tensor                 1.5         2012-05-05 [2] RSPM (R 4.4.0)
 TH.data                1.1-2       2023-04-17 [2] RSPM (R 4.4.0)
 tibble               * 3.2.1       2023-03-20 [2] RSPM (R 4.4.0)
 tidyr                * 1.3.1       2024-01-24 [2] RSPM (R 4.4.0)
 tidyselect             1.2.1       2024-03-11 [2] RSPM (R 4.4.0)
 tidyverse            * 2.0.0.9000  2024-06-19 [2] Github (tidyverse/tidyverse@62f32d4)
 timechange             0.3.0       2024-01-18 [2] RSPM (R 4.4.0)
 tzdb                   0.4.0       2023-05-12 [2] RSPM (R 4.4.0)
 UCSC.utils             1.0.0       2024-04-30 [2] RSPM (R 4.4.0)
 UpSetR               * 1.4.0       2024-06-19 [2] Github (hms-dbmi/UpSetR@b14854a)
 utf8                   1.2.4       2023-10-22 [2] RSPM (R 4.4.0)
 uwot                   0.2.2       2024-04-21 [2] RSPM (R 4.4.0)
 vctrs                  0.6.5       2023-12-01 [2] RSPM (R 4.4.0)
 vipor                  0.4.7       2023-12-18 [2] RSPM (R 4.4.0)
 viridis              * 0.6.5       2024-01-29 [2] RSPM (R 4.4.0)
 viridisLite          * 0.4.2       2023-05-02 [2] RSPM (R 4.4.0)
 vroom                  1.6.5       2023-12-05 [2] RSPM (R 4.4.0)
 withr                  3.0.1       2024-07-31 [2] RSPM (R 4.4.0)
 xfun                   0.47        2024-08-17 [2] RSPM (R 4.4.0)
 xtable                 1.8-4       2019-04-21 [2] RSPM (R 4.4.0)
 XVector                0.44.0      2024-04-30 [2] RSPM (R 4.4.0)
 yaml                   2.3.10      2024-07-26 [2] RSPM (R 4.4.0)
 zeallot                0.1.0       2018-01-28 [2] RSPM (R 4.4.0)
 zlibbioc               1.50.0      2024-04-30 [2] RSPM (R 4.4.0)
 zoo                    1.8-12      2023-04-13 [2] RSPM (R 4.4.0)

 [1] /home/etretiakov/R/x86_64-pc-linux-gnu-library/4.4
 [2] /opt/R/4.4.0/lib/R/library

─ Python configuration ───────────────────────────────────────────────────────
 python:         /opt/python/3.8.8/bin/python
 libpython:      /opt/python/3.8.8/lib/libpython3.8.so
 pythonhome:     /opt/python/3.8.8:/opt/python/3.8.8
 version:        3.8.8 | packaged by conda-forge | (default, Feb 20 2021, 16:22:27)  [GCC 9.3.0]
 numpy:          /opt/python/3.8.8/lib/python3.8/site-packages/numpy
 numpy_version:  1.23.5
 scanpy:         /home/etretiakov/.local/lib/python3.8/site-packages/scanpy
 
 NOTE: Python version was forced by RETICULATE_PYTHON

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>